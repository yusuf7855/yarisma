<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpectraLoop v3.6 - DUAL Temperature + Reflector Counter System</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="logo">SPECTRALOOP v3.6 - DUAL TEMP + REFLECTOR PRODUCTION</div>
        <div class="subtitle">Production Motor Control System - Levitation(1-4) Thrust(5-6) - DUAL Temperature Safety + Ultra-Fast Reflector Counter</div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Left Panel - Individual Motor Controls + Temperature -->
        <div class="control-panel">
            <div class="panel-title">🎛️ İndividüel Motor Kontrolleri</div>
            
            <!-- DUAL Temperature Section - ENHANCED -->
            <div class="temperature-section" id="temperature-section">
                <div class="temperature-header">
                    <h4>🌡️ ÇIFT Sensör Sıcaklığı</h4>
                    <div class="temp-emergency-indicator" id="temp-emergency" style="display: none;">
                        <span class="emergency-text">ALARM!</span>
                    </div>
                </div>
                
                <!-- DUAL SENSOR MAIN DISPLAY -->
                <div class="temperature-main">
                    <!-- Primary Sensor (Pin 8) -->
                    <div class="sensor-reading primary" id="sensor1-reading">
                        <div class="sensor-label">Sensör 1 (Pin 8)</div>
                        <div class="temp-current primary" id="sensor1-temp">25.0°C</div>
                        <div class="sensor-connection-status">
                            <span id="sensor1-status-mini" class="sensor-connection-mini connected">●</span>
                            <span id="sensor1-status-text">Bağlı</span>
                        </div>
                    </div>
                    
                    <!-- Secondary Sensor (Pin 13) -->
                    <div class="sensor-reading secondary" id="sensor2-reading">
                        <div class="sensor-label">Sensör 2 (Pin 13)</div>
                        <div class="temp-current secondary" id="sensor2-temp">25.0°C</div>
                        <div class="sensor-connection-status">
                            <span id="sensor2-status-mini" class="sensor-connection-mini connected">●</span>
                            <span id="sensor2-status-text">Bağlı</span>
                        </div>
                    </div>
                    
                    <!-- Safety Temperature (Max) -->
                    <div class="sensor-reading safety" id="safety-reading">
                        <div class="sensor-label">Güvenlik (Max)</div>
                        <div class="temp-current safety" id="safety-temp">25.0°C</div>
                        <div class="temp-status">
                            <span id="temp-status-text">Güvenli</span>
                        </div>
                    </div>
                </div>
                
                <!-- DUAL SENSOR DETAILS -->
                <div class="dual-sensor-details">
                    <div class="sensor-detail-group">
                        <h5>Sensör 1 Detayları</h5>
                        <div class="sensor-detail-item">
                            <span class="sensor-detail-label">Max:</span>
                            <span class="sensor-detail-value" id="sensor1-max">25.0°C</span>
                        </div>
                        <div class="sensor-detail-item">
                            <span class="sensor-detail-label">Bağlantı:</span>
                            <span class="sensor-detail-value" id="sensor1-connection">Bağlı</span>
                        </div>
                    </div>
                    <div class="sensor-detail-group">
                        <h5>Sensör 2 Detayları</h5>
                        <div class="sensor-detail-item">
                            <span class="sensor-detail-label">Max:</span>
                            <span class="sensor-detail-value" id="sensor2-max">25.0°C</span>
                        </div>
                        <div class="sensor-detail-item">
                            <span class="sensor-detail-label">Bağlantı:</span>
                            <span class="sensor-detail-value" id="sensor2-connection">Bağlı</span>
                        </div>
                    </div>
                </div>
                
                <!-- TEMPERATURE DIFFERENCE WARNING -->
                <div class="temp-difference-warning" id="temp-difference-warning" style="display: none;">
                    <div class="temp-diff-text">
                        ⚠️ Büyük Sensör Farkı Tespit Edildi! Fark: <span id="temp-difference-value">0.0°C</span>
                    </div>
                </div>
                
                <!-- REDUNDANCY STATUS -->
                <div class="redundancy-status">
                    <div class="redundancy-label">Sensör Redundancy:</div>
                    <div class="redundancy-value" id="sensor-redundancy-status">Çift Aktif</div>
                </div>
                
                <!-- TEMPERATURE CONTROLS -->
                <div class="temp-controls">
                    <button class="buzzer-btn" id="buzzer-off-btn" onclick="turnOffBuzzer()" disabled>
                        🔇 Buzzer Kapat
                    </button>
                    <button class="sensor-detail-btn" onclick="showSensorDetails()">
                        📊 Sensör Detayları
                    </button>
                    <div class="temp-last-update">
                        Son güncelleme: <span id="temp-last-update">--:--:--</span>
                    </div>
                </div>
            </div>

            <!-- NEW: REFLECTOR COUNTER SECTION -->
            <div class="reflector-section" id="reflector-section">
                <div class="reflector-header">
                    <h4>📏 Omron Reflektor Sayacı</h4>
                    <div class="reflector-status-indicator" id="reflector-status" style="display: none;">
                        <span class="status-text">AKTIF</span>
                    </div>
                </div>
                
                <!-- REFLECTOR MAIN DISPLAY -->
                <div class="reflector-main">
                    <div class="reflector-count-display">
                        <div class="count-label">Toplam Sayım</div>
                        <div class="count-current" id="reflector-count">0</div>
                        <div class="count-status">
                            <span id="reflector-system-status">Aktif</span>
                            <span id="reflector-connection-mini" class="sensor-connection-mini connected">●</span>
                        </div>
                    </div>
                    
                    <div class="reflector-voltage-display">
                        <div class="voltage-label">Sensör Voltajı</div>
                        <div class="voltage-current" id="reflector-voltage">5.00V</div>
                        <div class="voltage-status">
                            <span id="reflector-detection-state">Temiz</span>
                        </div>
                    </div>
                    
                    <div class="reflector-speed-display">
                        <div class="speed-label">Ortalama Hız</div>
                        <div class="speed-current" id="reflector-avg-speed">0.0</div>
                        <div class="speed-unit">ref/dk</div>
                    </div>
                </div>
                
                <!-- REFLECTOR DETAILED INFO -->
                <div class="reflector-details">
                    <div class="reflector-detail-group">
                        <h5>Performans</h5>
                        <div class="reflector-detail-item">
                            <span class="reflector-detail-label">Anlık Hız:</span>
                            <span class="reflector-detail-value" id="reflector-instant-speed">0.0 ref/dk</span>
                        </div>
                        <div class="reflector-detail-item">
                            <span class="reflector-detail-label">Okuma Frek:</span>
                            <span class="reflector-detail-value" id="reflector-read-freq">0.0 Hz</span>
                        </div>
                        <div class="reflector-detail-item">
                            <span class="reflector-detail-label">Max Hız:</span>
                            <span class="reflector-detail-value" id="reflector-max-speed">0.0 ref/dk</span>
                        </div>
                    </div>
                    <div class="reflector-detail-group">
                        <h5>İstatistikler</h5>
                        <div class="reflector-detail-item">
                            <span class="reflector-detail-label">Oturum:</span>
                            <span class="reflector-detail-value" id="reflector-session-count">0</span>
                        </div>
                        <div class="reflector-detail-item">
                            <span class="reflector-detail-label">Günlük:</span>
                            <span class="reflector-detail-value" id="reflector-daily-count">0</span>
                        </div>
                        <div class="reflector-detail-item">
                            <span class="reflector-detail-label">Çalışma:</span>
                            <span class="reflector-detail-value" id="reflector-runtime">0.0 dk</span>
                        </div>
                    </div>
                </div>
                
                <!-- REFLECTOR CONTROLS -->
                <div class="reflector-controls">
                    <button class="reflector-btn reset-btn" onclick="resetReflectorCounter()">
                        🔄 Sayacı Sıfırla
                    </button>
                    <button class="reflector-btn calibrate-btn" onclick="calibrateReflectorSensor()">
                        🎯 Kalibre Et
                    </button>
                    <button class="reflector-btn detail-btn" onclick="showReflectorDetails()">
                        📈 Detaylı İstatistik
                    </button>
                    <div class="reflector-last-update">
                        Son sayım: <span id="reflector-last-update">--:--:--</span>
                    </div>
                </div>
            </div>
            
            <!-- System Status -->
            <div class="system-status">
                <div class="status-item">
                    <div class="status-label">Arduino</div>
                    <div class="status-value status-connected" id="arduino-status">Bağlı</div>
                </div>
                <div class="status-item">
                    <div class="status-label">Sistem</div>
                    <div class="status-value status-armed" id="system-status">Hazır</div>
                </div>
                <div class="status-item">
                    <div class="status-label">Aktif Motor</div>
                    <div class="status-value" id="motor-count">0/6</div>
                </div>
                <div class="status-item">
                    <div class="status-label">Röle</div>
                    <div class="status-value" id="relay-status">Pasif</div>
                </div>
            </div>

            <!-- Arming Section -->
            <div class="arm-section">
                <button class="arm-button" id="arm-button" onclick="toggleArm()">
                    🔧 SİSTEMİ HAZIRLA
                </button>
            </div>

            <!-- Individual Motor Cards -->
            <div class="individual-motors">
                <div class="motor-card" data-motor="1">
                    <div class="motor-header">
                        <span class="motor-label">Motor 1 (Lev-Pin2)</span>
                        <span class="motor-status off" id="motor1-status">OFF</span>
                    </div>
                    <div class="motor-controls">
                        <button class="motor-btn start-btn" onclick="startMotor(1)" id="motor1-start">▶</button>
                        <button class="motor-btn stop-btn" onclick="stopMotor(1)" id="motor1-stop">⏹</button>
                        <input type="number" class="speed-input" id="motor1-speed-input" min="0" max="100" value="50" onchange="setMotorSpeed(1, this.value)">
                    </div>
                    <div class="speed-display" id="motor1-speed-display">Hız: 0%</div>
                </div>

                <div class="motor-card" data-motor="2">
                    <div class="motor-header">
                        <span class="motor-label">Motor 2 (Lev-Pin4)</span>
                        <span class="motor-status off" id="motor2-status">OFF</span>
                    </div>
                    <div class="motor-controls">
                        <button class="motor-btn start-btn" onclick="startMotor(2)" id="motor2-start">▶</button>
                        <button class="motor-btn stop-btn" onclick="stopMotor(2)" id="motor2-stop">⏹</button>
                        <input type="number" class="speed-input" id="motor2-speed-input" min="0" max="100" value="50" onchange="setMotorSpeed(2, this.value)">
                    </div>
                    <div class="speed-display" id="motor2-speed-display">Hız: 0%</div>
                </div>

                <div class="motor-card" data-motor="3">
                    <div class="motor-header">
                        <span class="motor-label">Motor 3 (Lev-Pin5)</span>
                        <span class="motor-status off" id="motor3-status">OFF</span>
                    </div>
                    <div class="motor-controls">
                        <button class="motor-btn start-btn" onclick="startMotor(3)" id="motor3-start">▶</button>
                        <button class="motor-btn stop-btn" onclick="stopMotor(3)" id="motor3-stop">⏹</button>
                        <input type="number" class="speed-input" id="motor3-speed-input" min="0" max="100" value="50" onchange="setMotorSpeed(3, this.value)">
                    </div>
                    <div class="speed-display" id="motor3-speed-display">Hız: 0%</div>
                </div>

                <div class="motor-card" data-motor="4">
                    <div class="motor-header">
                        <span class="motor-label">Motor 4 (Lev-Pin6)</span>
                        <span class="motor-status off" id="motor4-status">OFF</span>
                    </div>
                    <div class="motor-controls">
                        <button class="motor-btn start-btn" onclick="startMotor(4)" id="motor4-start">▶</button>
                        <button class="motor-btn stop-btn" onclick="stopMotor(4)" id="motor4-stop">⏹</button>
                        <input type="number" class="speed-input" id="motor4-speed-input" min="0" max="100" value="50" onchange="setMotorSpeed(4, this.value)">
                    </div>
                    <div class="speed-display" id="motor4-speed-display">Hız: 0%</div>
                </div>

                <div class="motor-card" data-motor="5">
                    <div class="motor-header">
                        <span class="motor-label">Motor 5 (Thr-Pin3)</span>
                        <span class="motor-status off" id="motor5-status">OFF</span>
                    </div>
                    <div class="motor-controls">
                        <button class="motor-btn start-btn" onclick="startMotor(5)" id="motor5-start">▶</button>
                        <button class="motor-btn stop-btn" onclick="stopMotor(5)" id="motor5-stop">⏹</button>
                        <input type="number" class="speed-input" id="motor5-speed-input" min="0" max="100" value="50" onchange="setMotorSpeed(5, this.value)">
                    </div>
                    <div class="speed-display" id="motor5-speed-display">Hız: 0%</div>
                </div>

                <div class="motor-card" data-motor="6">
                    <div class="motor-header">
                        <span class="motor-label">Motor 6 (Thr-Pin7)</span>
                        <span class="motor-status off" id="motor6-status">OFF</span>
                    </div>
                    <div class="motor-controls">
                        <button class="motor-btn start-btn" onclick="startMotor(6)" id="motor6-start">▶</button>
                        <button class="motor-btn stop-btn" onclick="stopMotor(6)" id="motor6-stop">⏹</button>
                        <input type="number" class="speed-input" id="motor6-speed-input" min="0" max="100" value="50" onchange="setMotorSpeed(6, this.value)">
                    </div>
                    <div class="speed-display" id="motor6-speed-display">Hız: 0%</div>
                </div>
            </div>
        </div>

        <!-- Middle Panel - Group Controls + Reflector Statistics -->
        <div class="control-panel">
            <div class="panel-title">🚀 Grup Kontrolleri + Reflektor İstatistik</div>
            
            <!-- NEW: REFLECTOR STATISTICS SECTION -->
            <div class="reflector-stats-section">
                <div class="stats-title">📊 Reflektor Performans İstatistikleri</div>
                
                <!-- Real-time Performance Chart Area -->
                <div class="performance-chart-area">
                    <div class="chart-header">
                        <h5>Gerçek Zamanlı Hız Grafiği</h5>
                        <div class="chart-controls">
                            <button class="chart-btn" onclick="toggleSpeedChart()">📈 Grafik</button>
                        </div>
                    </div>
                    <div class="mini-chart" id="reflector-speed-chart">
                        <canvas id="speed-chart-canvas" width="300" height="100"></canvas>
                    </div>
                </div>
                
                <!-- Statistics Grid -->
                <div class="reflector-stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Toplam Sayım</div>
                        <div class="stat-value reflector-value" id="stats-total-count">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Ortalama Hız</div>
                        <div class="stat-value speed-value" id="stats-avg-speed">0.0 ref/dk</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Çalışma Süresi</div>
                        <div class="stat-value time-value" id="stats-runtime">0h 0m</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Verimlilik</div>
                        <div class="stat-value efficiency-value" id="stats-efficiency">100%</div>
                    </div>
                </div>
                
                <!-- Temperature vs Reflector Correlation -->
                <div class="correlation-display">
                    <div class="correlation-header">
                        <h5>🌡️ Sıcaklık - Reflektor Korelasyonu</h5>
                    </div>
                    <div class="correlation-data">
                        <div class="correlation-item">
                            <span class="correlation-label">Sıc./Hız Oranı:</span>
                            <span class="correlation-value" id="temp-speed-ratio">0.0</span>
                        </div>
                        <div class="correlation-item">
                            <span class="correlation-label">Sistem Yükü:</span>
                            <span class="correlation-value" id="system-load-indicator">Normal</span>
                        </div>
                        <div class="correlation-item">
                            <span class="correlation-label">Performans:</span>
                            <span class="correlation-value" id="performance-indicator">Optimal</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Levitation Group -->
            <div class="group-control">
                <div class="group-title">🔮 Levitasyon Grubu (M1,2,3,4)</div>
                <div class="group-info">Pin: 2,4,5,6 - Levitation Motors</div>
                <div class="group-speed-control">
                    <button class="speed-btn" onclick="adjustGroupSpeed('levitation', -10)">−</button>
                    <input type="range" class="speed-slider" id="levitation-slider" 
                           min="0" max="100" value="0" 
                           oninput="setGroupSpeed('levitation', this.value)">
                    <button class="speed-btn" onclick="adjustGroupSpeed('levitation', 10)">+</button>
                    <span class="speed-value" id="levitation-speed">0%</span>
                </div>
                <div class="group-buttons">
                    <button class="group-btn start-btn" onclick="startGroup('levitation')">🚀 BAŞLAT</button>
                    <button class="group-btn stop-btn" onclick="stopGroup('levitation')">⏹ DURDUR</button>
                </div>
            </div>

            <!-- Thrust Group -->
            <div class="group-control">
                <div class="group-title">⚡ İtki Grubu (M5,6)</div>
                <div class="group-info">Pin: 3,7 - Thrust Motors</div>
                <div class="group-speed-control">
                    <button class="speed-btn" onclick="adjustGroupSpeed('thrust', -10)">−</button>
                    <input type="range" class="speed-slider" id="thrust-slider" 
                           min="0" max="100" value="0" 
                           oninput="setGroupSpeed('thrust', this.value)">
                    <button class="speed-btn" onclick="adjustGroupSpeed('thrust', 10)">+</button>
                    <span class="speed-value" id="thrust-speed">0%</span>
                </div>
                <div class="group-buttons">
                    <button class="group-btn start-btn" onclick="startGroup('thrust')">⚡ BAŞLAT</button>
                    <button class="group-btn stop-btn" onclick="stopGroup('thrust')">⏹ DURDUR</button>
                </div>
            </div>

            <!-- System Controls -->
            <div class="system-controls">
                <h4 class="controls-title">🔧 Sistem Kontrolleri</h4>
                <div class="control-grid">
                    <button class="system-btn relay-brake-on" onclick="controlRelayBrake('on')">
                        🔌 RÖLE AKTİF
                    </button>
                    <button class="system-btn relay-brake-off" onclick="controlRelayBrake('off')">
                        ⚡ RÖLE PASİF
                    </button>
                    <button class="system-btn brake-on" onclick="controlBrake('on')">
                        🔒 SW BRAKE ON
                    </button>
                    <button class="system-btn brake-off" onclick="controlBrake('off')">
                        🔓 SW BRAKE OFF
                    </button>
                    <button class="system-btn emergency-btn" onclick="emergencyStop()">
                        🚨 ACİL DURDURMA
                    </button>
                </div>
            </div>
        </div>

        <!-- Right Panel - Enhanced System Info + Reflector Monitoring -->
        <div class="control-panel">
            <div class="panel-title">📊 Sistem Bilgileri + Reflektor Monitör</div>
            
            <!-- ENHANCED Temperature Info Section -->
            <div class="info-section">
                <h4 class="section-title">🌡️ ÇIFT Sensör Detayları</h4>
                <div class="info-grid">
                    <div class="info-item">
                        <div class="info-label">Sensör 1</div>
                        <div class="info-value temp-value" id="detailed-sensor1-temp">25.0°C</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Sensör 2</div>
                        <div class="info-value temp-value" id="detailed-sensor2-temp">25.0°C</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Güvenlik Max</div>
                        <div class="info-value temp-value" id="detailed-safety-temp">25.0°C</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Fark</div>
                        <div class="info-value" id="detailed-temp-diff">0.0°C</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">S1 Max</div>
                        <div class="info-value temp-value" id="detailed-sensor1-max">25.0°C</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">S2 Max</div>
                        <div class="info-value temp-value" id="detailed-sensor2-max">25.0°C</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Redundancy</div>
                        <div class="info-value" id="detailed-redundancy-status">Çift Aktif</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Update Hz</div>
                        <div class="info-value" id="temp-update-frequency">0.0 Hz</div>
                    </div>
                </div>
            </div>
            
            <!-- NEW: ENHANCED Reflector Monitoring Section -->
            <div class="info-section">
                <h4 class="section-title">📏 Reflektor Sistem Monitörü</h4>
                <div class="info-grid">
                    <div class="info-item">
                        <div class="info-label">Toplam Sayım</div>
                        <div class="info-value reflector-value" id="monitor-reflector-count">0</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Sensör Voltajı</div>
                        <div class="info-value voltage-value" id="monitor-reflector-voltage">5.00V</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Ortalama Hız</div>
                        <div class="info-value speed-value" id="monitor-avg-speed">0.0/dk</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Anlık Hız</div>
                        <div class="info-value speed-value" id="monitor-instant-speed">0.0/dk</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Okuma Frekansı</div>
                        <div class="info-value freq-value" id="monitor-read-freq">0.0 Hz</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Sistem Durumu</div>
                        <div class="info-value system-value" id="monitor-system-status">Aktif</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Oturum Sayımı</div>
                        <div class="info-value session-value" id="monitor-session-count">0</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Çalışma Süresi</div>
                        <div class="info-value runtime-value" id="monitor-runtime">0.0dk</div>
                    </div>
                </div>
            </div>
            
            <!-- Performance Info -->
            <div class="info-section">
                <h4 class="section-title">📈 Sistem Performansı</h4>
                <div class="info-grid">
                    <div class="info-item">
                        <div class="info-label">Toplam RPM</div>
                        <div class="info-value rpm-value" id="total-rpm">0</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Güç Tüketimi</div>
                        <div class="info-value power-value" id="power-usage">0W</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Aktif Motorlar</div>
                        <div class="info-value motor-value" id="active-motors">0/6</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Röle Durumu</div>
                        <div class="info-value relay-value" id="relay-brake-status">Pasif</div>
                    </div>
                </div>
            </div>

            <!-- Enhanced Connection Status with Reflector -->
            <div class="info-section">
                <h4 class="section-title">🔗 Bağlantı Durumu</h4>
                <div class="connection-status">
                    <div class="connection-item">
                        <span class="connection-label">Backend:</span>
                        <div class="connection-dot" id="backend-status"></div>
                        <span class="connection-text" id="backend-text">Bağlantısız</span>
                    </div>
                    <div class="connection-item">
                        <span class="connection-label">Arduino:</span>
                        <div class="connection-dot" id="arduino-connection-status"></div>
                        <span class="connection-text" id="arduino-text">Bağlantısız</span>
                    </div>
                    <div class="connection-item">
                        <span class="connection-label">Sensör 1:</span>
                        <div class="connection-dot" id="sensor1-dot"></div>
                        <span class="connection-text" id="sensor1-status-text">Bağlantısız</span>
                    </div>
                    <div class="connection-item">
                        <span class="connection-label">Sensör 2:</span>
                        <div class="connection-dot" id="sensor2-dot"></div>
                        <span class="connection-text" id="sensor2-status-text">Bağlantısız</span>
                    </div>
                    <div class="connection-item">
                        <span class="connection-label">Reflektor:</span>
                        <div class="connection-dot" id="reflector-dot"></div>
                        <span class="connection-text" id="reflector-connection-text">Bağlantısız</span>
                    </div>
                    <div class="connection-item">
                        <span class="connection-label">Son Güncelleme:</span>
                        <span class="update-time" id="last-update">--:--:--</span>
                    </div>
                </div>
                
                <div class="connection-controls">
                    <button class="connection-btn test-btn" onclick="testConnection()">
                        🔍 BAĞLANTI TESTİ
                    </button>
                    <button class="connection-btn reconnect-btn" onclick="reconnectArduino()">
                        🔄 YENİDEN BAĞLAN
                    </button>
                </div>
            </div>

            <!-- Command Log -->
            <div class="info-section">
                <h4 class="section-title">📝 Komut Geçmişi</h4>
                <div id="command-log" class="command-log">
                    <div class="log-entry">DUAL sensör + reflektor sistemi başlatılıyor...</div>
                </div>
            </div>

            <!-- Enhanced System Stats -->
            <div class="info-section">
                <h4 class="section-title">📊 Sistem İstatistikleri</h4>
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-label">Komutlar:</span>
                        <span class="stat-value" id="total-commands">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Hatalar:</span>
                        <span class="stat-value error-stat" id="total-errors">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Uptime:</span>
                        <span class="stat-value" id="uptime">0s</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Port:</span>
                        <span class="stat-value" id="arduino-port">--</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Emergency Stop Button -->
    <div class="emergency-stop" onclick="emergencyStop()">
        <div class="emergency-icon">🚨</div>
        <div class="emergency-text">STOP</div>
    </div>

    <!-- ENHANCED Temperature Emergency Warning with Reflector Data -->
    <div class="temperature-emergency-warning" id="temperature-emergency-warning" style="display: none;">
        <div class="warning-content">
            <div class="warning-icon">🌡️🚨</div>
            <div class="warning-text">
                <div class="warning-title">ÇIFT SENSÖR SICAKLIK ALARMI!</div>
                <div class="warning-subtitle">Sistem güvenlik nedeniyle durduruldu</div>
                <div class="warning-temp-details">
                    <div class="warning-temp-item">
                        <div class="warning-temp-label">Sensör 1</div>
                        <div class="warning-temp-value" id="warning-temp1-value">--°C</div>
                    </div>
                    <div class="warning-temp-item">
                        <div class="warning-temp-label">Sensör 2</div>
                        <div class="warning-temp-value" id="warning-temp2-value">--°C</div>
                    </div>
                    <div class="warning-temp-item">
                        <div class="warning-temp-label">Maximum</div>
                        <div class="warning-temp-value" id="warning-temp-max-value">--°C</div>
                    </div>
                </div>
                <div class="warning-reflector-info">
                    <div class="warning-subtitle">Son Reflektor Durumu:</div>
                    <div class="warning-reflector-item">
                        <span class="warning-reflector-label">Final Sayım:</span>
                        <span class="warning-reflector-value" id="warning-reflector-count">0</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- NEW: Reflector Detail Modal -->
    <div class="reflector-detail-modal" id="reflector-detail-modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">📏 Omron Reflektor Detay İstatistikleri</h3>
                <span class="modal-close" onclick="hideReflectorDetails()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="modal-section">
                    <h4>Gerçek Zamanlı Veriler</h4>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Toplam Sayım:</span>
                        <span class="modal-detail-value" id="modal-reflector-count">0</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Sensör Voltajı:</span>
                        <span class="modal-detail-value" id="modal-reflector-voltage">5.00V</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Algılama Durumu:</span>
                        <span class="modal-detail-value" id="modal-detection-state">Temiz</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Ortalama Hız:</span>
                        <span class="modal-detail-value" id="modal-avg-speed">0.0 ref/dk</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Anlık Hız:</span>
                        <span class="modal-detail-value" id="modal-instant-speed">0.0 ref/dk</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Max Hız:</span>
                        <span class="modal-detail-value" id="modal-max-speed">0.0 ref/dk</span>
                    </div>
                </div>
                <div class="modal-section">
                    <h4>Performans & İstatistikler</h4>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Oturum Sayımı:</span>
                        <span class="modal-detail-value" id="modal-session-count">0</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Günlük Sayım:</span>
                        <span class="modal-detail-value" id="modal-daily-count">0</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Çalışma Süresi:</span>
                        <span class="modal-detail-value" id="modal-runtime">0.0 dakika</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Algılama Oranı:</span>
                        <span class="modal-detail-value" id="modal-detection-rate">0.0/dk</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Okuma Frekansı:</span>
                        <span class="modal-detail-value" id="modal-read-freq">0.0 Hz</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Sistem Durumu:</span>
                        <span class="modal-detail-value" id="modal-system-active">Aktif</span>
                    </div>
                </div>
                <div class="modal-section">
                    <h4>Kalibrasyon & Konfigürasyon</h4>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Algılama Eşiği:</span>
                        <span class="modal-detail-value" id="modal-detect-threshold">4.64V</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Bırakma Eşiği:</span>
                        <span class="modal-detail-value" id="modal-release-threshold">4.89V</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Son Kalibrasyon:</span>
                        <span class="modal-detail-value" id="modal-last-calibration">Henüz yapılmadı</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Min Voltaj:</span>
                        <span class="modal-detail-value" id="modal-min-voltage">0.0V</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Max Voltaj:</span>
                        <span class="modal-detail-value" id="modal-max-voltage">5.0V</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Ortalama Voltaj:</span>
                        <span class="modal-detail-value" id="modal-avg-voltage">5.0V</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Sensor Detail Modal with Reflector Correlation -->
    <div class="sensor-detail-modal" id="sensor-detail-modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">🌡️ ÇIFT Sensör + Reflektor Korelasyon Detayları</h3>
                <span class="modal-close" onclick="hideSensorDetails()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="modal-section">
                    <h4>Sensör 1 (Pin 8) - Primary</h4>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Mevcut Sıcaklık:</span>
                        <span class="modal-detail-value" id="modal-sensor1-temp">25.0°C</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Maximum Sıcaklık:</span>
                        <span class="modal-detail-value" id="modal-sensor1-max">25.0°C</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Bağlantı Durumu:</span>
                        <span class="modal-detail-value" id="modal-sensor1-connection">Bağlı</span>
                    </div>
                </div>
                <div class="modal-section">
                    <h4>Sensör 2 (Pin 13) - Secondary</h4>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Mevcut Sıcaklık:</span>
                        <span class="modal-detail-value" id="modal-sensor2-temp">25.0°C</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Maximum Sıcaklık:</span>
                        <span class="modal-detail-value" id="modal-sensor2-max">25.0°C</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Bağlantı Durumu:</span>
                        <span class="modal-detail-value" id="modal-sensor2-connection">Bağlı</span>
                    </div>
                </div>
                <div class="modal-section">
                    <h4>Güvenlik & Redundancy</h4>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Güvenlik Sıcaklığı:</span>
                        <span class="modal-detail-value" id="modal-safety-temp">25.0°C</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Sensör Farkı:</span>
                        <span class="modal-detail-value" id="modal-temp-diff">0.0°C</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Update Frekansı:</span>
                        <span class="modal-detail-value" id="modal-temp-update-freq">0.0 Hz</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Redundancy Status:</span>
                        <span class="modal-detail-value" id="modal-redundancy">Çift Aktif</span>
                    </div>
                </div>
                <div class="modal-section">
                    <h4>Reflektor Korelasyonu</h4>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Reflektor Sayımı:</span>
                        <span class="modal-detail-value" id="modal-correlation-count">0</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Hız:</span>
                        <span class="modal-detail-value" id="modal-correlation-speed">0.0 ref/dk</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Sıc./Hız Oranı:</span>
                        <span class="modal-detail-value" id="modal-temp-speed-ratio">0.0</span>
                    </div>
                    <div class="modal-detail-item">
                        <span class="modal-detail-label">Sistem Yükü:</span>
                        <span class="modal-detail-value" id="modal-system-load">Normal</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification">
        <div class="notification-content">
            <span class="notification-icon" id="notification-icon">ℹ️</span>
            <span class="notification-message" id="notification-message">Mesaj</span>
        </div>
        <button class="notification-close" onclick="closeNotification()">×</button>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">DUAL sensör + reflektor sistemi başlatılıyor...</div>
    </div>

    <!-- Scripts -->
    <script src="script.js"></script>
</body>
</html>